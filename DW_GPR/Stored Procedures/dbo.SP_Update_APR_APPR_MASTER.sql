SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE     PROCEDURE [dbo].[SP_Update_APR_APPR_MASTER]
(@APR_APPR_MASTER_ID	INT,
@APPR_DOCUMENT_TYPE	NVARCHAR(20 ),
@APPR_DOCUMENT_ID	NVARCHAR(20 ),
@APPR_SEQUENCE	int,
@APPR_USERID	NVARCHAR(20 ),
@APPR_DELEGATEE	NVARCHAR(20 ),
@APPR_APPROVAL_ROLE	NVARCHAR(100 ),
@APPR_STATUS	NVARCHAR(100 ),
@APPR_DATE	DATETIME2(7),
@APPR_COMMENT	NVARCHAR(1000 ),
@APPR_IP	NVARCHAR(20 ),
@APPR_BROWSER_INFO	NVARCHAR(100 ),
@APPR_PLATFORM	NVARCHAR(100 ),
@APPR_KEY	NVARCHAR(100 ),
@MODIFIED_DATE	DATETIME2(7),
@UPDATEDATETIME DATETIME,
@DW2_UPDATE_TIME DATETIME,
@DELETE_FLAG    NVARCHAR(3),
@DW	            INT
)
	  
AS

BEGIN

SET NOCOUNT ON;

IF @DW=2 
	BEGIN
		UPDATE dbo.T_GPR_MM_DW2_APR_APPR_MASTER

		SET
		APPR_DOCUMENT_TYPE=	@APPR_DOCUMENT_TYPE,
		 APPR_DOCUMENT_ID	=@APPR_DOCUMENT_ID,
		 APPR_SEQUENCE	=@APPR_SEQUENCE,
		 APPR_USERID	=@APPR_USERID,
		 APPR_DELEGATEE	=@APPR_DELEGATEE,
		 APPR_APPROVAL_ROLE=	@APPR_APPROVAL_ROLE,
		 APPR_STATUS=	@APPR_STATUS,
		 APPR_DATE	=@APPR_DATE,
		 APPR_COMMENT=	@APPR_COMMENT,
		 APPR_IP	=@APPR_IP,
		 APPR_BROWSER_INFO=	@APPR_BROWSER_INFO,
		 APPR_PLATFORM=	@APPR_PLATFORM,
		 APPR_KEY=	@APPR_KEY,
		 
		 MODIFIED_DATE=	@MODIFIED_DATE,
		--INSERTDATETIME=	@INSERTDATETIME,
		UPDATEDATETIME=	@UPDATEDATETIME,
		DELETE_FLAG=@DELETE_FLAG



		WHERE APR_APPR_MASTER_ID = @APR_APPR_MASTER_ID  
	END

IF @DW=3 
	BEGIN
		UPDATE dbo.T_GPR_MM_DW3_APR_APPR_MASTER

		SET
		APPR_DOCUMENT_TYPE=	@APPR_DOCUMENT_TYPE,
		 APPR_DOCUMENT_ID	=@APPR_DOCUMENT_ID,
		 APPR_SEQUENCE	=@APPR_SEQUENCE,
		 APPR_USERID	=@APPR_USERID,
		 APPR_DELEGATEE	=@APPR_DELEGATEE,
		 APPR_APPROVAL_ROLE=	@APPR_APPROVAL_ROLE,
		 APPR_STATUS=	@APPR_STATUS,
		 APPR_DATE	=@APPR_DATE,
		 APPR_COMMENT=	@APPR_COMMENT,
		 APPR_IP	=@APPR_IP,
		 APPR_BROWSER_INFO=	@APPR_BROWSER_INFO,
		 APPR_PLATFORM=	@APPR_PLATFORM,
		 APPR_KEY=	@APPR_KEY,
		 MODIFIED_DATE=	@MODIFIED_DATE,
		--INSERTDATETIME=	@INSERTDATETIME,
		UPDATEDATETIME=	@UPDATEDATETIME,
		DELETE_FLAG=@DELETE_FLAG,
		DW2_UPDATE_TIME=@DW2_UPDATE_TIME


		WHERE APR_APPR_MASTER_ID = @APR_APPR_MASTER_ID  
	END

END
GO
